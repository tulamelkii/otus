sudo su
sudo apt install ntp -y
sudo systemctl restart ntp
echo "deb https://deb.debian.org/debian unstable main" >> /etc/apt/sources.list
echo "deb https://deb.debian.org/debian sid main contrib non-free" >> /etc/apt/sources.list
apt update
apt install wget dpkg-dev build-essential devscripts debhelper -y
apt install  libpcre3-dev libpcre2-dev quilt zlib1g-dev libssl-dev -y
mkdir nginx && cd nginx
wget https://nginx.org/download/nginx-1.25.0.tar.gz
tar -xvf nginx-1.25.0.tar.gz
cd nginx-1.25.0/
wget nginx.org/packages/mainline/debian/pool/nginx/n/nginx/nginx_1.25.0-1~bullseye.debian.tar.xz
tar -xvf nginx_1.25.0-1~bullseye.debian.tar.xz
rm -rf nginx_1.25.0-1~bullseye.debian.tar.xz
sed -i 's~Maintainer: NGINX Packaging <nginx-packaging@f5.com>~Maintainer: Vitalii Best <tulamelkii@yandex.ru>~g' /home/vagrant/nginx/nginx-1.25.0/debian/control
sed -i 's~Homepage: https://nginx.org~Homepage: https://github.com/tulamelkii~g' /home/vagrant/nginx/nginx-1.25.0/debian/control
sed -i 's~-- Nginx Packaging <nginx-packaging@f5.com>  Tue, 23 May 2023 10:03:19 -0700~-- Vitalii Best <tulamelkii@yandex.ru>  Sun, 3 Jun 2023 13:32:19 +0300~g' /home/vagrant/nginx/nginx-1.25.0/debian/changelog
sed -i 's~rm -f $(CURDIR)/objs~rm -rf $(CURDIR)/objs~g' /home/vagrant/nginx/nginx-1.25.0/debian/rules
sudo ./configure --sbin-path=/usr/sbin/nginx --conf-path=/etcnginix/nginx.conf --with-http_ssl_module
dpkg-buildpackage -us -uc -b
cd /home/vagrant/nginx
apt install ./nginx_1.25.0-1~bullseye_amd64.deb
systemctl restart nginx
systemctl enable nginx
systemctl status nginx
cd /usr/share/nginx/html/
mkdir repo
cp /home/vagrant/nginx/nginx-dbg_1.25.0-1~bullseye_amd64.deb /usr/share/nginx/html/repo/
cd /usr/share/nginx/html/repo
touch /etc/nginx/conf.d/repo.conf
echo 'server {
    listen 80;
    server_name localhost;
    location /repo {
        autoindex on;
        alias /usr/share/nginx/html/repo/;
    }
}' > /etc/nginx/conf.d/repo.conf
cd /
rm -rf /etc/nginx/conf.d/default.conf
systemctl restart nginx
nginx -t
nginx -s reload
echo 'deb http://localhost/repo/ bookworm main' >> /etc/apt/sources.list
apt update
curl -a http://localhost/repo/

